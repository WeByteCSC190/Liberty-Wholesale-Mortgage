version: '2'

services:
    backend:
      # restart: unless-stopped
      build:
          context: .
          dockerfile: ./Dockerfile            
      command: gunicorn ./mortgage_dashboard.wsgi --bind 0.0.0.0:8000            
      ports:
          - "8000:8000"    

    frontend: 
      # restart: unless-stopped
      build:
          context: .
          dockerfile: ./frontend/Dockerfile
      volumes:
          - static_volume:/app/frontend/build
    nginx:
      image: nginx:latest
      ports:
        - 80:8080
      volumes:
          - ./nginx/default.conf:/etc/nginx/conf.d/default.conf:ro
          - static_volume:/var/www/app/frontend
      depends_on:
        - backend
        - frontend

volumes:
  static_volume: {}
    